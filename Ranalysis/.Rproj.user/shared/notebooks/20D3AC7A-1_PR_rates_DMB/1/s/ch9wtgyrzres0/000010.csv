"0",""
"0","# refit model using nlsLM"
"0","verrucosa.fit_nlsLM <- minpack.lm::nlsLM(micromol.cm2.h~sharpeschoolhigh_1981(temp = temp, r_tref,e,eh,th, tref = 28),"
"0","                        data = d.verrucosa,"
"0","                        start = coef(verrucosa.fit),"
"0","                        lower = low_lims,"
"0","                        upper = upper_lims,"
"0","                        weights = rep(1, times = nrow(d.verrucosa)))"
"0",""
"0","# bootstrap using case resampling"
"0","verrucosa.boot1 <- Boot(verrucosa.fit_nlsLM, method = 'case')"
"0",""
"0","# look at the data"
"0","head(verrucosa.boot1$t)"
"1","    "
"1","   r_tref"
"1","         e"
"1","       eh"
"1"," th"
"1","
[1,]"
"1"," 1.856059"
"1"," 0.4081714"
"1"," 1.360905"
"1"," 36"
"1","
[2,]"
"1"," 1.856059"
"1"," 0.4969179"
"1"," 1.369365"
"1"," 36"
"1","
[3,]"
"1"," 1.856059"
"1"," 0.4358787"
"1"," 1.350196"
"1"," 36"
"1","
[4,]"
"1"," 1.856059"
"1"," 0.4196817"
"1"," 1.387230"
"1"," 36"
"1","
[5,]"
"1"," 1.856059"
"1"," 0.4797259"
"1"," 1.273176"
"1"," 36"
"1","
[6,]"
"1"," 1.856059"
"1"," 0.4589348"
"1"," 1.305001"
"1"," 36"
"1","
"
"0","# create predictions of each bootstrapped model"
"0","verrucosa.boot1_preds <- verrucosa.boot1$t %>%"
"0","  as.data.frame() %>%"
"0","  drop_na() %>%"
"0","  mutate(iter = 1:n()) %>%"
"0","  group_by_all() %>%"
"0","  do(data.frame(temp = seq(min(d.verrucosa$temp), max(d.verrucosa$temp), length.out = 100))) %>%"
"0","  ungroup() %>%"
"0","  mutate(pred = sharpeschoolhigh_1981(temp, r_tref, e, eh, th, tref = 28))"
"0",""
"0","# calculate bootstrapped confidence intervals"
"0","verrucosa.boot1_conf_preds <- group_by(verrucosa.boot1_preds, temp) %>%"
"0","  summarise(conf_lower = quantile(pred, 0.025),"
"0","            conf_upper = quantile(pred, 0.975)) %>%"
"0","  ungroup()"
"0",""
"0","# plot bootstrapped CIs"
"0","verrucosa.CI.plot <- ggplot() +"
"0","  geom_line(aes(temp, .fitted), verrucosa.preds, col = 'cyan') +"
"0","  geom_ribbon(aes(temp, ymin = conf_lower, ymax = conf_upper), verrucosa.boot1_conf_preds, fill = 'cyan', alpha = 0.3) +"
"0","  geom_point(aes(temp, micromol.cm2.h), d.verrucosa, size = 2, alpha = 0.5,col = 'cyan') +"
"0","  theme_bw(base_size = 12) +"
"0","  labs(x = 'Temperature (ÂºC)',"
"0","       y = 'Rate (nmol O2/cm2/h')"
"0","verrucosa.CI.plot"
"0",""
