"0","### Merge rates with sample info"
"0","pr <- left_join("
"0","  select(df.out, colony_id, Light_Value, micromol.L.s),"
"0","  distinct(metadata, colony_id, Run, Chamber.Vol.L)"
"0",")"
"0",""
"0","### Correct for chamber volume and blanks"
"0","pr <- pr %>%"
"0","  mutate(micromol.s = micromol.L.s * Chamber.Vol.L)"
"0",""
"0","# Get blank values -- average for each run and light value in case multiple blanks"
"0","blanks <- pr %>%"
"0","  filter(grepl(""BK"", colony_id)) %>%"
"0","  group_by(Run, Light_Value) %>%"
"0","  summarise(micromol.s.blank = mean(micromol.s))"
"0",""
"0","# Join blank values with rest of data and subtract values from samples for same run and light value"
"0","pr <- left_join(pr, blanks) %>%"
"0","  mutate(micromol.s.adj = micromol.s - micromol.s.blank) %>%"
"0","  # After correcting for blank values, remove blanks from data"
"0","  filter(!grepl(""BK"", colony_id))"
"0",""
"0",""
"0","# Import surface area data"
"0","sa <- read.csv(""output/1_surface_area.csv"")"
"0",""
"0","# Join surface area with rest of data"
"0","pr <- left_join(pr, select(sa, colony_id, surface.area.cm2))"
"0",""
"0","# Normalize rates by surface area"
"0","pr <- pr %>%"
"0","  mutate(micromol.cm2.s = micromol.s.adj / surface.area.cm2,"
"0","         micromol.cm2.h = micromol.cm2.s * 3600)"
