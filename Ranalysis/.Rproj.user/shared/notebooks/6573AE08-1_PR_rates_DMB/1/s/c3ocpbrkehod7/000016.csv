"0",""
"0","Photodata$temp <- as.numeric(Photodata$Temp.Cat)"
"0","Photodata$micromol.cm2.h <- Photodata$micromol.cm2.h+1"
"0",""
"0","# choose model"
"0","get_model_names()"
"1"," [1]"
"1"," ""beta_2012""            "
"1"," ""boatman_2017""         "
"1"," ""briere2_1999""         "
"1"," ""delong_2017""          "
"1","
"
"1"," [5]"
"1"," ""flinn_1991""           "
"1"," ""gaussian_1987""        "
"1"," ""hinshelwood_1947""     "
"1"," ""joehnk_2008""          "
"1","
"
"1"," [9]"
"1"," ""johnsonlewin_1946""    "
"1"," ""kamykowski_1985""      "
"1"," ""lactin2_1995""         "
"1"," ""lrf_1991""             "
"1","
"
"1","[13]"
"1"," ""modifiedgaussian_2006"""
"1"," ""oneill_1972""          "
"1"," ""pawar_2018""           "
"1"," ""quadratic_2008""       "
"1","
"
"1","[17]"
"1"," ""ratkowsky_1983""       "
"1"," ""rezende_2019""         "
"1"," ""sharpeschoolfull_1981"""
"1"," ""sharpeschoolhigh_1981"""
"1","
"
"1","[21]"
"1"," ""sharpeschoollow_1981"" "
"1"," ""spain_1982""           "
"1"," ""thomas_2012""          "
"1"," ""thomas_2017""          "
"1","
"
"1","[25]"
"1"," ""weibull_1995""         "
"1","
"
"0","#sharpeschoolhigh_1981"
"0",""
"0","# get start vals"
"0","start_vals <- get_start_vals(Photodata$temp,Photodata$micromol.cm2.h, model_name = 'sharpeschoolhigh_1981')"
"0",""
"0","# get limits"
"0","low_lims <- get_lower_lims(Photodata$temp,Photodata$micromol.cm2.h, model_name = 'sharpeschoolhigh_1981')"
"0","upper_lims <- get_upper_lims(Photodata$temp,Photodata$micromol.cm2.h, model_name = 'sharpeschoolhigh_1981')"
"0",""
"0","#view values"
"0","start_vals"
"1","      r_tref "
"1","           e "
"1","          eh "
"1","          th "
"1","
"
"1","2.005262e+00 "
"1","8.799035e-04 "
"1","4.401506e-03 "
"1","3.143243e+01 "
"1","
"
"0","low_lims"
"1","r_tref "
"1","     e "
"1","    eh "
"1","    th "
"1","
"
"1","     0 "
"1","     0 "
"1","     0 "
"1","     1 "
"1","
"
"0","upper_lims"
"1","   r_tref "
"1","        e "
"1","       eh "
"1","       th "
"1","
"
"1"," 2.010893 "
"1","10.000000 "
"1","20.000000 "
"1","36.000000 "
"1","
"
"0","#GRANDIS"
"0","# grandis CURVE FIT"
"0","d.grandis <- Photodata %>% "
"0","  filter(Morphology==""grandis"")"
"0",""
"0","#fit "
"0","grandis.fit <- nls_multstart(micromol.cm2.h~sharpeschoolhigh_1981(temp = temp, r_tref,e,eh,th, tref = 28),"
"0","                                                     data = d.grandis,"
"0","                                                     iter = 500,"
"0","                                                     start_lower = start_vals - 1,"
"0","                                                     start_upper = start_vals + 1,"
"0","                                                     lower = low_lims,"
"0","                                                     upper = upper_lims,"
"0","                                                     supp_errors = 'Y')"
"0",""
"0","grandis.fit"
"1","Nonlinear regression model
"
"1","  model: "
"1",""
"1","micromol.cm2.h ~ sharpeschoolhigh_1981(temp = temp, r_tref, e, "
"1",""
"1","    eh, th, tref = 28)"
"1",""
"1","
"
"1","   data: "
"1",""
"1","data"
"1",""
"1","
"
"1"," r_tref "
"1","      e "
"1","     eh "
"1","     th "
"1","
"
"1"," 2.0109 "
"1"," 0.3294 "
"1"," 3.6408 "
"1","36.0000 "
"1","
"
"1"," "
"1",""
"1","residual sum-of-squares: "
"1",""
"1","5.933"
"1",""
"1","
"
"1","
Number of iterations"
"1"," "
"1","to convergence:"
"1"," "
"1","21"
"1"," "
"1","
Achieved convergence tolerance:"
"1"," "
"1","1.49e-08"
"1","
"
"0","#generate the predicted data"
"0","grandis_new_data <- data.frame(temp = seq(min(d.grandis$temp), max(d.grandis$temp), 0.5))"
"0","grandis.preds <- augment(grandis.fit, newdata = grandis_new_data)"
"0",""
"0","#calculate TPC parameters"
"0","grandis.TCP.res <- calc_params(grandis.fit) %>%"
"0","  mutate_all(round, 2)   # round "
"0",""
"0","grandis.TCP.res "
