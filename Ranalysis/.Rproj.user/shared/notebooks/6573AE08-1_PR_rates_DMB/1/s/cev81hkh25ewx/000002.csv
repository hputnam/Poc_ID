"0","### Merge rates with sample info"
"0","pr <- left_join("
"0","  select(df.out, fragment_ID, Light_Value, micromol.L.s),"
"0","  distinct(metadata, fragment_ID, Treatment, Run, Chamber.Vol.L, Date)"
"0",")"
"0",""
"0","### Correct for chamber volume and blanks"
"0","pr <- pr %>%"
"0","  mutate(micromol.s = micromol.L.s * Chamber.Vol.L)"
"0",""
"0","# Get blank values -- average for each run and light value in case multiple blanks"
"0","blanks <- pr %>%"
"0","  filter(grepl(""BLK"", fragment_ID)) %>%"
"0","  group_by(Run, Light_Value) %>%"
"0","  summarise(micromol.s.blank = mean(micromol.s))"
"0",""
"0","# Join blank values with rest of data and subtract values from samples for same run and light value"
"0","pr <- left_join(pr, blanks) %>%"
"0","  mutate(micromol.s.adj = micromol.s - micromol.s.blank) %>%"
"0","  # After correcting for blank values, remove blanks from data"
"0","  filter(!grepl(""BLK"", fragment_ID))"
"0",""
"0",""
"0","# Import surface area data"
"0","sa <- read_csv(file = ""data/surface.area.calc.csv"")"
"0",""
"0","# Join surface area with rest of data"
"0","pr <- left_join(pr, select(sa, fragment_ID, surface.area.cm2))"
"0",""
"0","# Normalize rates by surface area"
"0","pr <- pr %>%"
"0","  mutate(micromol.cm2.s = micromol.s.adj / surface.area.cm2,"
"0","         micromol.cm2.h = micromol.cm2.s * 3600)"
"0",""
"0","Photo <- pr %>%"
"0","  filter(Light_Value ==620)"
"0",""
"0","Photo <- left_join(Photo, select(metadata,fragment_ID, Temp.Cat))"
