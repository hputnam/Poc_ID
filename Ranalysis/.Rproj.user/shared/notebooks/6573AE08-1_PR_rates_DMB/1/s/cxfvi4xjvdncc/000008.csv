"0",""
"0","# refit model using nlsLM"
"0","meandrina.fit_nlsLM <- minpack.lm::nlsLM(micromol.cm2.h~sharpeschoolhigh_1981(temp = temp, r_tref,e,eh,th, tref = 28),"
"0","                        data = d.meandrina,"
"0","                        start = coef(meandrina.fit),"
"0","                        lower = low_lims,"
"0","                        upper = upper_lims,"
"0","                        weights = rep(1, times = nrow(d.meandrina)))"
"0",""
"0","# bootstrap using case resampling"
"0","meandrina.boot1 <- Boot(meandrina.fit_nlsLM, method = 'case')"
"0",""
"0","# look at the data"
"0","head(meandrina.boot1$t)"
"1","    "
"1","   r_tref"
"1","         e"
"1","       eh"
"1","       th"
"1","
[1,]"
"1"," 1.570186"
"1"," 0.1942350"
"1"," 2.892131"
"1"," 35.58408"
"1","
[2,]"
"1"," 1.588446"
"1"," 0.1635223"
"1"," 2.472028"
"1"," 36.00000"
"1","
[3,]"
"1"," 1.794730"
"1"," 0.3754233"
"1"," 2.268765"
"1"," 33.53718"
"1","
[4,]"
"1"," 1.507724"
"1"," 0.1439299"
"1"," 3.307752"
"1"," 36.00000"
"1","
[5,]"
"1"," 1.551481"
"1"," 0.1206387"
"1"," 2.774727"
"1"," 36.00000"
"1","
[6,]"
"1"," 1.673436"
"1"," 0.2395120"
"1"," 2.589550"
"1"," 35.09537"
"1","
"
"0","# create predictions of each bootstrapped model"
"0","meandrina.boot1_preds <- meandrina.boot1$t %>%"
"0","  as.data.frame() %>%"
"0","  drop_na() %>%"
"0","  mutate(iter = 1:n()) %>%"
"0","  group_by_all() %>%"
"0","  do(data.frame(temp = seq(min(d.meandrina$temp), max(d.meandrina$temp), length.out = 100))) %>%"
"0","  ungroup() %>%"
"0","  mutate(pred = sharpeschoolhigh_1981(temp, r_tref, e, eh, th, tref = 28))"
"0",""
"0","# calculate bootstrapped confidence intervals"
"0","meandrina.boot1_conf_preds <- group_by(meandrina.boot1_preds, temp) %>%"
"0","  summarise(conf_lower = quantile(pred, 0.025),"
"0","            conf_upper = quantile(pred, 0.975)) %>%"
"0","  ungroup()"
"0",""
"0","# plot bootstrapped CIs"
"0","meandrina.CI.plot <- ggplot() +"
"0","  geom_line(aes(temp, .fitted), meandrina.preds, col = 'black') +"
"0","  geom_ribbon(aes(temp, ymin = conf_lower, ymax = conf_upper), meandrina.boot1_conf_preds, fill = 'black', alpha = 0.3) +"
"0","  geom_point(aes(temp, micromol.cm2.h), d.meandrina, size = 2, alpha = 0.5,col = 'black') +"
"0","  theme_bw(base_size = 12) +"
"0","  labs(x = 'Temperature (ÂºC)',"
"0","       y = 'Rate (nmol O2/cm2/h')"
"0","meandrina.CI.plot "
"0",""
