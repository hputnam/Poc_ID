"0","path.p <- ""data/PR"" #the location of all your respirometry files "
"0",""
"0","# List data files"
"0","file.names <- list.files(path = path.p, pattern = ""csv$"")  # list all csv file names in the folder"
"0","file.names <- file.names[!grepl(""metadata"", file.names)]   # omit metadata from files to be read in as data"
"0",""
"0","# Load PI curve sample metadata (i.e., which corals were in which runs)"
"0","sample.info <- read_csv(file = ""data/PR/PR_sample_metadata.csv"")"
"0",""
"0","# Load PI curve run metadata (i.e., light levels and interval times for each run)"
"0","run.info <- read_csv(file = ""data/PR/PR_run_metadata.csv"")"
"0",""
"0","# Join all coral and run metadata"
"0","metadata <- full_join(sample.info, run.info) %>%"
"0","  mutate(Date = as_date(as.character(Date), format = ""%Y%m%d"", tz = ""Tahiti""))"
"0",""
"0","# Select only certain columnns"
"0","metadata <- metadata %>%"
"0","  select(fragment_ID, Run, Treatment, Chamber.Vol.L, Date, Start.time, Stop.time, Light_Value, Temp.Cat)"
"0",""
"0","# Read in all data files"
"0","#edit fragment_ID name to remove .csv and change _TP1 to _1"
"0","df <- tibble(file.name = file.names) %>%"
"0","  mutate(fragment_ID = gsub(""_.*"", """", file.name)) %>%  # Get fragment_ID from filename and select for info after the first _"
"0","  mutate(fragment_ID = gsub("".csv"", """", fragment_ID),  #remove .csv from fragment_ID"
"0","          info = map(fragment_ID, ~filter(metadata, fragment_ID == .)),           # Get associated sample info"
"0","         data0 = map(file.name, ~read_csv(file.path(path.p, .), skip = 1, col_types = cols(.default = ""d"", Time = ""t""))))   # Get associated O2 data"
"0",""
"0","# Select only Time, Value, and Temp columns from O2 data"
"0","df <- df %>%"
"0","  mutate(data0 = map(data0, ~select(., Time, Value, Temp)))%>%"
"0","  mutate(data0 = map(data0, ~(.x %>% filter(complete.cases(.))))) #remove NAs to get rid of artifact line in our data"
"0",""
